(function(){$(function(){jQuery.writeCookie=function(c,d,e){var b,a;a="";if(e){b=new Date();b.setTime(b.getTime()+(e*86400000));a="; expires="+b.toGMTString()}document.cookie=c+"="+d+a+"; path=/";return true};jQuery.readCookie=function(b){var g,a,d,f,e;f=b+"=";a=document.cookie.split(";");for(d=0,e=a.length;0<=e?d<e:d>e;0<=e?d++:d--){g=a[d];while(g.charAt(0)===" "){g=g.substring(1,g.length)}if(g.indexOf(f)===0){return g.substring(f.length,g.length)}}return null};$("#intro .hide-info").click(function(){$("#intro").slideUp("fast",function(){$.writeCookie("hide-intro",true);return true});return true});$("#bookmark-widget .close, #bookmark-widget .cancel").click(function(){$("#bookmark-widget").hide("fast");return true});$("#bookmark-widget .add-category").keyup(function(b){var a;if(b.keyCode===13){b.preventDefault();a=$('<span class="btn small" />').text($(this).val());$("#bookmark-widget .categories").append(a).show()}return true});$("#add-button").click(function(){$("#bookmark-widget").show(function(){var a,c,b;b=$(".categories .selected");a=$("#bookmark-widget .categories");c=$('<span class="btn small" />;');if(b.length>0){a.html("");b.each(function(){var d;d=c.clone().text($(this).text());a.append(d);return true});a.show()}else{a.hide()}return true});return true});$(".categories .columns").click(function(a){if(a.ctrlKey===true){a.preventDefault();$(this).toggleClass("selected")}else{if($(a.srcElement).hasClass("category-actions")){return}$(this).toggleClass("expanded").parent().isotope("reLayout")}return true}).find("span").live("click",function(){var c,b,a,d;b=$(this);a=$("#category-manager");c=b.parents(".columns");if(a.data("category-id")===c.data("id")&&a.is(":visible")){a.hide();c.removeClass("active")}else{a.css({top:b.offset().top+16,left:b.offset().left+b.outerWidth()/2-a.outerWidth()/2}).data("category-id",c.data("id"));d=a.find(".star").removeClass("on");if(c.data("marked")){d.addClass("on")}$(".categories .columns").removeClass("active");c.addClass("active");a.show()}return true});$("#category-manager .star").click(function(){var a,b;b=$(this);b.toggleClass("on");a=b.hasClass("on");$.get("/kategorie/"+$("#category-manager").data("category-id")+"/ustaw-zaznaczenie/"+(a?"tak":"nie"),function(){var e,c,f,d;if(a){d=$("#marked-categories");c=$("#normal-categories")}else{d=$("#normal-categories");c=$("#marked-categories")}f=$("#category-manager").data("category-id");e=$("#category-"+f);e.data("marked",a);d.find(".categories").isotope("insert",e.clone(true,true));c.find(".categories").isotope("remove",e);$(".categories").isotope("reLayout");if(c.find(".columns").length===0){c.hide()}if(!d.is(":visible")){d.show()}return true});return true});$("#load").ajaxStart(function(){return $(this).show()}).ajaxStop(function(){return $(this).hide()});$(document).click(function(a){if(!$(a.target).hasClass("category-actions")){$("#category-manager").hide();$(".categories .columns").removeClass("active");return true}});$(document).keyup(function(a){if(a.keyCode===83&&!$(a.target).is("input")){$("#category-manager").hide();$("#search").show();$("#search-input").val("").focus().trigger("keyup")}if(a.keyCode===27){$("#search").hide();return $("#search-input").val("").blur().trigger("keyup")}});$("#search-input").keyup(function(){var a;a=$(this).val();if(a.length>0){$(".categories").isotope({filter:':contains("'+a+'")'})}else{$(".categories").isotope({filter:"*"})}$("#category-manager").hide();return true});$(".categories").isotope({itemSelector:".columns",masonry:{columnWidth:240},getSortData:{name:function(a){return a.data("name")}},sortBy:"name"});$(".categories-block h6 ul a").click(function(d){var a,c,b;d.preventDefault();b=$(this);c=b.data("layout");a=b.parents(".categories-block").find(".categories");if(a.data("layout")===c){return}b.parents("ul").find("a").toggleClass("active");return a.toggleClass("grid list").data("layout",c).isotope({layoutMode:c})});return true})}).call(this);